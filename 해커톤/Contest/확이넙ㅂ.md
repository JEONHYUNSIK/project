# Contest Service API 테스트 가이드

## 🌐 **접근 정보**
- **API Gateway**: `http://localhost:8080/api/contests`

---

## 🔧 **현재 구현된 API**

### 1. 서비스 상태 확인
```powershell
curl -X GET http://localhost:8080/api/contests/test
```

### 2. 대회 목록 조회 (인증 필요)
```powershell
# 기본 조회
curl -X GET http://localhost:8080/api/contests -b cookies.txt

# 페이징
curl -X GET "http://localhost:8080/api/contests?page=0&size=10" -b cookies.txt

# 카테고리 필터링
curl -X GET "http://localhost:8080/api/contests?category=1" -b cookies.txt

# 키워드 검색
curl -X GET "http://localhost:8080/api/contests?keyword=프로그래밍" -b cookies.txt
```

### 3. 대회 상세 조회 (인증 필요)
```powershell
curl -X GET http://localhost:8080/api/contests/{대회-UUID} -b cookies.txt
```

---

## 🔐 **JWT 토큰 인증**

### JWT 토큰 사용법 (쿠키 방식)
```powershell
# 인증이 필요한 API 호출시 쿠키 포함
curl -X GET http://localhost:8080/api/contests -b cookies.txt

# 또는 쿠키 파일 없이 직접 사용
curl -X GET http://localhost:8080/api/contests -H "Cookie: auth_token=YOUR_JWT_TOKEN"
```

### 회원가입 및 로그인으로 JWT 토큰 받기
```powershell
# 1. 회원가입 (먼저 계정 생성)
curl -X POST http://localhost:60000/auth/register -H "Content-Type: application/json" -d '{"username": "asdf", "password": "asdfasdf", "email": "asdf@example.com"}'

# 2. 로그인 API - Auth Server 직접 호출 (쿠키로 토큰 받음)
curl -X POST http://localhost:60000/auth/login -H "Content-Type: application/json" -d '{"username": "asdf", "password": "asdfasdf"}' -c cookies.txt

# 응답 예시:
# {
#   "message": "Login successful",
#   "user": {
#     "id": 1,
#     "username": "asdf",
#     "email": "asdf@example.com"
#   }
# }
# JWT 토큰은 쿠키에 저장됨
```

---

## 🧪 **테스트 방법**

```powershell
# 1. 서비스 확인
curl -X GET http://localhost:8080/api/contests/test

# 2. 회원가입 (최초 1회만)
curl -X POST http://localhost:60000/auth/register -H "Content-Type: application/json" -d '{"username": "asdf", "password": "asdfasdf", "email": "asdf@example.com", "phone_number": "01000000000"}'

# 3. 로그인해서 JWT 토큰 받기 (쿠키 저장)
curl -X POST http://localhost:60000/auth/login -H "Content-Type: application/json" -d '{"username": "asdf1234", "password": "asdf1234"}' -c cookies.txt

# 4. 대회 목록 확인 (쿠키 사용)
curl -X GET http://localhost:8080/api/contests -b cookies.txt

# 5. 대회 상세 확인 (위에서 받은 UUID 사용)
curl -X POST http://localhost:8080/api/contests/favorite/10000000-0000-0000-0000-000000000002/favoritesAdd -b cookies.txt

# 6. 사용자별 즐겨찾기 목록 조회
curl -X GET http://localhost:8080/api/contests/favorite/favoritesList -b cookies.txt

# 7. 즐겨찾기 여부
curl -X GET http://localhost:8080/api/contests/favorite/00000000-0000-0000-0000-000000000001/isfavorites -b cookies.txt

# 8. 마이페이지 쓸 사용자가 누른 공모전 대회 정보
curl -X GET http://localhost:8080/api/mypage/favorites -b cookies.txt


# 임의 공모전 추가
curl -X POST http://localhost:8080/api/contests -H "Content-Type: application/json" -d '{"title": "3번에서 1번으로 카테고리 수정 전", "description": "새로운 대회의 설명입니다", "organizer": "테스트 주최자", "startDate": "2025-08-01T09:00:00", "endDate": "2025-08-31T18:00:00", "registrationDeadline": "2025-07-30T23:59:59", "prizeDescription": "상금 500만원", "requirements": "요구사항ABC", "websiteUrl": "http://example.com/new-contest", "imageUrl": "http://example.com/image.jpg", "isActive": "true", "organizerEmail": "organizer@example.com", "organizerPhone": "010-1234-5678", "submissionFormat": "PDF", "maxParticipants": 100, "eligibility": ["학생", "일반인"], "tags": ["코딩", "AI"], "categoryIds": [{"id": 3}]}' -b cookies.txt

# 공모전 카테고리 수정
curl -X PUT http://localhost:8080/api/contests/{공모전UUID} -H "Content-Type: application/json" -d '{"title": "카테고리1에서 8번으로 수정", "description": "카테고리가 잘 수정되는지 확인합니다.", "categoryIds": [{"id": 5}]}' -b cookies.txt

# /api/contests/status?status=CLOSING_SOON	전체 공모전 중 마감임박인 것
# /api/categories/1/contests?status=CLOSING_SOON	카테고리 1에 속한 공모전 중 마감임박인 것
  curl -X GET "http://localhost:8080/api/categories/1/contests?status=CLOSING_SOON&page=0&size=10&sortBy=title&sortDir=asc" -b cookies.txt
  curl -X GET http://localhost:8080/api/categories/1/contests?status=CLOSING_SOON -b cookies.txt

  curl -X GET "http://localhost:8080/api/categories/1/contests?status=CLOSED&page=0&size=10&sortBy=title&sortDir=asc" -b cookies.txt
  curl -X GET http://localhost:8080/api/categories/1/contests?status=CLOSED -b cookies.txt      
  
  curl -X GET "http://localhost:8080/api/categories/1/contests?status=OPEN&page=0&size=10&sortBy=title&sortDir=asc" -b cookies.txt

# /api/categories/1/contests	카테고리 1에 속한 모든 공모전
 curl -X GET "http://localhost:8080/api/categories/1/contests?page=0&size=10&sortBy=title&sortDir=asc" -b cookies.txt




    //curl -X GET "http://localhost:8080/fortest"

    //curl -X GET "http://localhost:8080/api/contests?fortest?regionSi=서울"



    //curl -X GET "http://localhost:8080/fortest?regionSi=서울특별시&regionGu=강남구"
    //curl -X GET "http://localhost:8080/fortest?regionSi=서울특별시&regionGu=강남구&page=1&size=5"

    INSERT INTO contest_service.contest_regions(contest_id, region_id) VALUES 
  ('10000000-0000-0000-0000-000000000003',270),   
  ('10000000-0000-0000-0000-000000000006',449);

    금천구", 서울 //  해남군, 전남


    curl -X GET "http://localhost:8080/api/contests/test2?regionSi=%EC%84%9C%EC%9A%B8" -b cookies.txt

    //서울특별시
    curl -X GET "http://localhost:8080/api/contests/region?regionSi=%EC%84%9C%EC%9A%B8%ED%8A%B9%EB%B3%84%EC%8B%9C" -b cookies.txt
    //대구광역시
    curl -X GET "http://localhost:8080/api/contests/region?regionSi=%EB%8C%80%EA%B5%AC%EA%B4%91%EC%97%AD%EC%8B%9C" -b cookies.txt
  


    #카테고리 ID 1번 (IT)에 속하면서, 지역이 서울이고, 마감이 임박한 상태의 공모전들을 보고 싶다"
    curl -X GET "http://localhost:8080/api/categories/1/contests?status=CLOSING_SOON&regionSi=%EC%84%9C%EC%9A%B8%ED%8A%B9%EB%B3%84%EC%8B%9C" -b cookies.txt

    curl -X GET "http://localhost:8080/api/categories/1/contests?status=CLOSED&regionSi=%EC%84%9C%EC%9A%B8%ED%8A%B9%EB%B3%84%EC%8B%9C" -b cookies.txt
    
    curl -X GET "http://localhost:8080/api/categories/1/contests?status=OPEN&regionSi=%EC%84%9C%EC%9A%B8%ED%8A%B9%EB%B3%84%EC%8B%9C" -b cookies.txt




    

